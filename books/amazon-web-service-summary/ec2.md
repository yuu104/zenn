---
title: "EC2"
---

## とりあえずこれ読め

https://zenn.dev/mi_01_24fu/articles/aws-ec2-2024_08_07

## インスタンスのライフサイクル

EC2 インスタンスのライフサイクルの概要図は下記になります。

![](https://storage.googleapis.com/zenn-user-upload/a73b1e2f0c00-20240924.png)
_引用: https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/ec2-instance-lifecycle.html_

### pending

- インスタンスを起動させると、先ずはこの状態に移行します
- この段階で、インスタンスは起動状態に入る準備をしています
- 具体的には、AMI の情報を基にインスタンスの起動に必要なデータをルートデバイスにコピーし、セットアップに必要な全てのことを実行しています
- この時、まだ課金は発生しません

### running

- インスタンスが使用できる状態です
- この段階から課金が発生します

### Reboot

- OS の再起動と同等です
- インスタンスは同じホストコンピュータに残ります
- また、IP アドレスやその他のデータをルートデバイスのストレージに維持します
- **「Reboot」の動作は「Stop or hibernate → Start」とは異なります**

### Stop

- インスタンスの停止です
- **ルートデバイスが EBS の場合のみ可能です**
- 「Stop → Start」すると、インスタンスは新規ホストコンピュータに移行され、新たなパブリック IPv4 が割り当てられます
- 停止しても、削除されることはありません

:::details 停止により失われるリソース

- RAM に保存されているデータ
- インスタンスストアボリュームに保存されているデータは
- パブリック IPv4 アドレス

インスタンスの IP が変更されるのが嫌な場合、インスタンスに Elasic IP アドレスを関連づけることで対処できます。

:::

:::details 停止しても存続するリソース

- アタッチされた EBS ボリューム
- EBS ボリュームに保存されているデータ
- プライベート IPv4 アドレス
- IPv6 アドレス
- インスタンスに関連付けられた Elastic IP アドレス

インスタンスが停止すると、関連する Elastic IP アドレスに対する課金が始まります。

:::

### hibernate

- インスタンスの休止です
- **ルートデバイスが EBS の場合のみ可能です**
- 「停止（Stop）」との違いは、**「RAM に保存されているデータが残るかどうか」**です
- 「休止（hibernate）」の場合、RAM のデータは EBS ボリュームに保存されます

### stopping

- インスタンスを停止するための準備段階です
- 「停止（Stop）」の場合、課金対象にはなりません
- 「休止（hibernate）」の場合、課金対象になります

### stopped

- インスタンスが停止された状態です
- インスタンスに対する課金は発生しませんが、**EBS ボリュームに対しては課金が発生しています**
- そのため、不要なインスタンスは停止ではなく終了するようにしましょう

### Terminate

- インスタンスの終了（削除）です
- 状態が「shutting-down」または「terminated」に変わったら、課金は停止します
- インスタンスを削除した後に、再度起動することはできません
- ただし、**EBS ボリュームは残ります**
